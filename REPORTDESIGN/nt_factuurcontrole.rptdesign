<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.22" id="1">
    <property name="comments">Copyright (c) 2012 Nedtrain
Date Created: 2012-07-20
Created by: Willem Mullender</property>
    <property name="createdBy">Eclipse BIRT Designer Version 3.7.1.v20110905 Build &lt;3.7.1.v20110913-1734></property>
    <text-property name="title">Factuur controle</text-property>
    <html-property name="description">This template will create a report having a single header with multiple rows of data.</html-property>
    <property name="units">in</property>
    <method name="initialize"><![CDATA[importPackage(Packages.com.ibm.tivoli.maximo.report.script);
    mxReportScriptContext = MXReportScriptContext.initialize(reportContext);
    mxReportScriptContext.setDefaultLogLevel("DEBUG");
    mxReportScriptContext.setDefaultLogFile("C:/temp/factuurcontrole.log");]]></method>
    <method name="afterFactory"><![CDATA[MXReportScriptContext.close();]]></method>
    <property name="theme">MaximoSystemLibrary.maximoTheme</property>
    <text-property name="displayName">Tivoli Maximo List Template</text-property>
    <property name="layoutPreference">auto layout</property>
    <list-property name="libraries">
        <structure>
            <property name="fileName">MaximoSystemLibrary.rptlibrary</property>
            <property name="namespace">MaximoSystemLibrary</property>
        </structure>
    </list-property>
    <parameters>
        <scalar-parameter name="appname" id="200">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="paramdelimiter" id="202">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="paramstring" id="201">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="where" id="434">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <simple-property-list name="defaultValue">
                <value type="constant">1=1</value>
            </simple-property-list>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <script-data-source name="maximoDataSource" id="64" extends="MaximoSystemLibrary.maximoDataSource"/>
    </data-sources>
    <data-sets>
        <script-data-set name="Data Set" id="2560">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">KLANT</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">OVEREENKOMST</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">FACTUURBATCHNR</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">STATUSBATCHREGEL</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">PRIJSSCHEMA</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">WERKORDER</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">ACTIVUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">NEDTRAINMATERIEELSERIE</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">NEDTRAINSERIENUMMER</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">10</property>
                    <property name="name">ACTIVUMOMSCHRIJVING</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">11</property>
                    <property name="name">WERKORDEROMSCHRIJVING</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">12</property>
                    <property name="name">WERKELIJKESTARTDATUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">13</property>
                    <property name="name">WERKELIJKESTARTTIJD</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">14</property>
                    <property name="name">GEPLANDESTARTDATUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">15</property>
                    <property name="name">GEPLANDESTARTTIJD</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">16</property>
                    <property name="name">DIENST</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">17</property>
                    <property name="name">DIENSTGROEP</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">18</property>
                    <property name="name">TOTAALKOSTEN</property>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="position">19</property>
                    <property name="name">TOTAALTEFACTUREREN</property>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="position">20</property>
                    <property name="name">RESOURCEKOSTEN</property>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="position">21</property>
                    <property name="name">MATERIAALKOSTEN</property>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="position">22</property>
                    <property name="name">PRODUCTPRIJS</property>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="position">23</property>
                    <property name="name">RESOURCEPRIJS</property>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="position">24</property>
                    <property name="name">MATERIAALPRIJS</property>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="position">25</property>
                    <property name="name">Uren</property>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="position">26</property>
                    <property name="name">worklocation</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">27</property>
                    <property name="name">ntwarranty</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">28</property>
                    <property name="name">ntwontloctype</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">29</property>
                    <property name="name">masterpm</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">KLANT</property>
                </structure>
                <structure>
                    <property name="columnName">OVEREENKOMST</property>
                    <text-property name="displayName">Overeenkomst</text-property>
                </structure>
                <structure>
                    <property name="columnName">FACTUURBATCHNR</property>
                    <text-property name="displayName">Factuur-batch Nr</text-property>
                </structure>
                <structure>
                    <property name="columnName">STATUSBATCHREGEL</property>
                    <text-property name="displayName">Status batchregel</text-property>
                </structure>
                <structure>
                    <property name="columnName">PRIJSSCHEMA</property>
                    <text-property name="displayName">Prijsschema</text-property>
                </structure>
                <structure>
                    <property name="columnName">WERKORDER</property>
                    <text-property name="displayName">Werkorder</text-property>
                </structure>
                <structure>
                    <property name="columnName">ACTIVUM</property>
                    <text-property name="displayName">Activum</text-property>
                </structure>
                <structure>
                    <property name="columnName">NEDTRAINMATERIEELSERIE</property>
                    <text-property name="displayName">NedTrain Materieelserie</text-property>
                </structure>
                <structure>
                    <property name="columnName">NEDTRAINSERIENUMMER</property>
                    <text-property name="displayName">NedTrain Serienummer</text-property>
                </structure>
                <structure>
                    <property name="columnName">ACTIVUMOMSCHRIJVING</property>
                    <text-property name="displayName">Activum-omschrijving</text-property>
                </structure>
                <structure>
                    <property name="columnName">WERKORDEROMSCHRIJVING</property>
                    <text-property name="displayName">Werkorder-omschrijving</text-property>
                </structure>
                <structure>
                    <property name="columnName">WERKELIJKESTARTDATUM</property>
                    <text-property name="displayName">Werkelijke startdatum</text-property>
                </structure>
                <structure>
                    <property name="columnName">WERKELIJKESTARTTIJD</property>
                    <text-property name="displayName">Werkelijke starttijd</text-property>
                </structure>
                <structure>
                    <property name="columnName">GEPLANDESTARTDATUM</property>
                    <text-property name="displayName">Geplande startdatum</text-property>
                </structure>
                <structure>
                    <property name="columnName">GEPLANDESTARTTIJD</property>
                    <text-property name="displayName">Geplande starttijd</text-property>
                </structure>
                <structure>
                    <property name="columnName">DIENST</property>
                    <text-property name="displayName">Dienst</text-property>
                </structure>
                <structure>
                    <property name="columnName">DIENSTGROEP</property>
                    <text-property name="displayName">Dienstgroep</text-property>
                </structure>
                <structure>
                    <property name="columnName">TOTAALKOSTEN</property>
                    <text-property name="displayName">Totaal kosten</text-property>
                </structure>
                <structure>
                    <property name="columnName">TOTAALTEFACTUREREN</property>
                    <text-property name="displayName">Totaal te factureren</text-property>
                </structure>
                <structure>
                    <property name="columnName">RESOURCEKOSTEN</property>
                    <text-property name="displayName">Resourcekosten</text-property>
                </structure>
                <structure>
                    <property name="columnName">MATERIAALKOSTEN</property>
                    <text-property name="displayName">Materiaalkosten</text-property>
                </structure>
                <structure>
                    <property name="columnName">PRODUCTPRIJS</property>
                    <text-property name="displayName">Productprijs</text-property>
                </structure>
                <structure>
                    <property name="columnName">RESOURCEPRIJS</property>
                    <text-property name="displayName">Resourceprijs</text-property>
                </structure>
                <structure>
                    <property name="columnName">MATERIAALPRIJS</property>
                    <text-property name="displayName">Materiaalprijs</text-property>
                </structure>
                <structure>
                    <property name="columnName">Uren</property>
                </structure>
                <structure>
                    <property name="columnName">worklocation</property>
                </structure>
                <structure>
                    <property name="columnName">ntwarranty</property>
                </structure>
                <structure>
                    <property name="columnName">ntwontloctype</property>
                </structure>
                <structure>
                    <property name="columnName">masterpm</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">KLANT</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">OVEREENKOMST</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">FACTUURBATCHNR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">STATUSBATCHREGEL</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">PRIJSSCHEMA</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">WERKORDER</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">ACTIVUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">NEDTRAINMATERIEELSERIE</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">NEDTRAINSERIENUMMER</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">ACTIVUMOMSCHRIJVING</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">WERKORDEROMSCHRIJVING</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">WERKELIJKESTARTDATUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">WERKELIJKESTARTTIJD</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">GEPLANDESTARTDATUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">15</property>
                        <property name="name">GEPLANDESTARTTIJD</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">16</property>
                        <property name="name">DIENST</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">17</property>
                        <property name="name">DIENSTGROEP</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">18</property>
                        <property name="name">TOTAALKOSTEN</property>
                        <property name="dataType">float</property>
                    </structure>
                    <structure>
                        <property name="position">19</property>
                        <property name="name">TOTAALTEFACTUREREN</property>
                        <property name="dataType">float</property>
                    </structure>
                    <structure>
                        <property name="position">20</property>
                        <property name="name">RESOURCEKOSTEN</property>
                        <property name="dataType">float</property>
                    </structure>
                    <structure>
                        <property name="position">21</property>
                        <property name="name">MATERIAALKOSTEN</property>
                        <property name="dataType">float</property>
                    </structure>
                    <structure>
                        <property name="position">22</property>
                        <property name="name">PRODUCTPRIJS</property>
                        <property name="dataType">float</property>
                    </structure>
                    <structure>
                        <property name="position">23</property>
                        <property name="name">RESOURCEPRIJS</property>
                        <property name="dataType">float</property>
                    </structure>
                    <structure>
                        <property name="position">24</property>
                        <property name="name">MATERIAALPRIJS</property>
                        <property name="dataType">float</property>
                    </structure>
                    <structure>
                        <property name="position">25</property>
                        <property name="name">Uren</property>
                        <property name="dataType">float</property>
                    </structure>
                    <structure>
                        <property name="position">26</property>
                        <property name="name">worklocation</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">27</property>
                        <property name="name">ntwarranty</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">28</property>
                        <property name="name">ntwontloctype</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">29</property>
                        <property name="name">masterpm</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
maximoDataSet.open();

// 20130505 MPI: Elementtool # 1529
// 20130725 MPI: Elementtool # 3248
// 20140603 MPI: Removed columns as agreed with report owner to improve perfomance
// 20140911 MPI: added colums worklocation, locationtype, warranty
// 20150703 MPI: S28.RAP04 added masterpmnum in output

var sqlText = new String();

// Add query to sqlText variable.
sqlText = " " 
 + " SELECT  pluspbillbatch.customer KLANT "
 + " , pluspbillbatch.agreement Overeenkomst "
 + " , pluspbillbatch.billbatchnum FactuurbatchNr "
 + " , pluspbillline.status statusbatchregel "
 + " , pluspbillline.pricesched Prijsschema "
 + " , workorder.wonum Werkorder "
 + " , workorder.assetnum activum "
 + " , workorder.ntserie NedTrainMaterieelserie "
 + " , asset.serialnum NedTrainSerienummer "
 + " , asset.description Activumomschrijving "
 + " , replace(workorder.description, ';', '-') Werkorderomschrijving  "
 + " , to_char(workorder.actstart, 'DD-MM-YYYY') Werkelijkestartdatum "
 + " , to_char(workorder.actstart, 'HH24:MI') Werkelijkestarttijd "
 + " , to_char(workorder.schedstart, 'DD-MM-YYYY') Geplandestartdatum "
 + " , to_char(workorder.schedstart, 'HH24:MI') Geplandestarttijd "
 + " , workorder.commodity dienst "
 + " , workorder.commoditygroup dienstgroep "
 + " , pluspbillline.totalcost Totaalkosten "
 + " , pluspbillline.billedprice Totaaltefactureren "
 + " , labcost.Resourcekosten "
 + " , matusecost.Materiaalkosten "
 + " , gbcost.Productprijs "
 + " , labcost.Resourceprijs "
 + " , labcost.Uren "
 + " , matusecost.Materiaalprijs "
 + " , workorder.worklocation worklocation "
 + " , workorder.ntwarranty ntwarranty "
 + " , locations.ntwontloctype ntwontloctype "
 + " , pm.masterpm "
//  Calculated checks "
+ " from pluspbillbatch   "
 + "  left join pluspbillline   "
 + "    on pluspbillline.billbatchnum=pluspbillbatch.billbatchnum   "
 + "    and pluspbillline.orgid=pluspbillbatch.orgid   "
 + "      left outer join workorder   "
 + "        on workorder.wonum=pluspbillline.refwo   "
 + "        and workorder.orgid=pluspbillline.orgid   "
 + "          left outer join asset   "
 + "            on asset.assetnum=workorder.assetnum   "
 + "            and asset.siteid=workorder.siteid   "
 + "          left outer join locations   "
 + "            on locations.location=workorder.worklocation   "
 + "            and locations.siteid=workorder.siteid   "
 + "          left outer join pm on pm.pmnum = workorder.pmnum and pm.siteid = workorder.siteid "
 //+ "          left outer join masterpm on pm.masterpm = masterpm.masterpmnum  "


// Summing of costs and prices, beware the where clauses in the join when doing an update                "
// labour costs
 + "    left outer join "
 + "      ( "
 + "      select pbl2.pluspbilllineid "
 + "       , sum(labtrans.linecost) Resourcekosten "
 + "       , sum(labtrans.pluspbillprice) Resourceprijs "
+ "        , sum(labtrans.regularhrs) Uren " // ET#3248 
 + "      from pluspbillbatch "
 + "        left outer join pluspbillline pbl2 "
 + "          on pbl2.billbatchnum=pluspbillbatch.billbatchnum "
 + "          and pbl2.orgid=pluspbillbatch.orgid "
 + "            left outer join workorder wo2 "
 + "              on pbl2.refwo = wo2.wonum "
 + "                or (pbl2.refwo = wo2.parent and wo2.istask=1) "
 + "                left outer join labtrans "
 + "                  on wo2.wonum = labtrans.refwo "
 + "                  and wo2.siteid = labtrans.siteid "
 + "      where    " + params["where"]
 + "      group by pbl2.pluspbilllineid "
 + "      ) labcost "
 + "    on pluspbillline.pluspbilllineid = labcost.pluspbilllineid "
 + "     "
 // Material costs
 + "    left outer join "
 + "      ( "
 + "      select pbl3.pluspbilllineid "
 + "       , sum(matusetrans.linecost) Materiaalkosten "
 + "       , sum(matusetrans.pluspbillprice) Materiaalprijs "
 + "      from pluspbillbatch "
 + "        left outer join pluspbillline pbl3 "
 + "          on pbl3.billbatchnum=pluspbillbatch.billbatchnum "
 + "          and pbl3.orgid=pluspbillbatch.orgid "
 + "            left outer join workorder wo3 "
 + "              on pbl3.refwo = wo3.wonum "
 + "                or (pbl3.refwo = wo3.parent and wo3.istask=1) "
 + "                left outer join matusetrans "
 + "                  on wo3.wonum = matusetrans.refwo "
 + "                  and wo3.siteid = matusetrans.siteid "
 + "      where    " + params["where"] 
 + "      group by pbl3.pluspbilllineid "
 + "      ) matusecost "
 + "    on pluspbillline.pluspbilllineid = matusecost.pluspbilllineid "
 + "     "
 // gb pricing
 + "    left outer join "
 + "      ( "
 + "      select pbl5.pluspbilllineid "
 + "       , sum(pluspgbtrans.billprice) Productprijs "
 + "      from pluspbillbatch "
 + "        left outer join pluspbillline pbl5 "
 + "          on pbl5.billbatchnum=pluspbillbatch.billbatchnum "
 + "          and pbl5.orgid=pluspbillbatch.orgid "
 + "            left outer join workorder wo5 "
 + "              on pbl5.refwo = wo5.wonum "
 + "                or (pbl5.refwo = wo5.parent and wo5.istask=1) "
 + "                left outer join pluspgbtrans "
 + "                  on wo5.wonum = pluspgbtrans.wonum "
 + "                  and wo5.siteid = pluspgbtrans.siteid "
 + "      where    " + params["where"] 
 + "      group by pbl5.pluspbilllineid "
 + "      ) gbcost "
 + "    on pluspbillline.pluspbilllineid = gbcost.pluspbilllineid     "
 + "  where    " + params["where"] 
;

maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	return (false);

// Add a line for each output column
// The specific get method should match the data type of the output column.
row["KLANT"] = maximoDataSet.getString("KLANT");
row["OVEREENKOMST"] = maximoDataSet.getString("OVEREENKOMST");
row["FACTUURBATCHNR"] = maximoDataSet.getString("FACTUURBATCHNR");
row["STATUSBATCHREGEL"] = maximoDataSet.getString("STATUSBATCHREGEL");
row["PRIJSSCHEMA"] = maximoDataSet.getString("PRIJSSCHEMA");
row["WERKORDER"] = maximoDataSet.getString("WERKORDER");
row["ACTIVUM"] = maximoDataSet.getString("ACTIVUM");
row["NEDTRAINMATERIEELSERIE"] = maximoDataSet.getString("NEDTRAINMATERIEELSERIE");
row["NEDTRAINSERIENUMMER"] = maximoDataSet.getString("NEDTRAINSERIENUMMER");
row["ACTIVUMOMSCHRIJVING"] = maximoDataSet.getString("ACTIVUMOMSCHRIJVING");
row["WERKORDEROMSCHRIJVING"] = maximoDataSet.getString("WERKORDEROMSCHRIJVING");
row["WERKELIJKESTARTDATUM"] = maximoDataSet.getString("WERKELIJKESTARTDATUM");
row["WERKELIJKESTARTTIJD"] = maximoDataSet.getString("WERKELIJKESTARTTIJD");
row["GEPLANDESTARTDATUM"] = maximoDataSet.getString("GEPLANDESTARTDATUM");
row["GEPLANDESTARTTIJD"] = maximoDataSet.getString("GEPLANDESTARTTIJD");
row["DIENST"] = maximoDataSet.getString("DIENST");
row["DIENSTGROEP"] = maximoDataSet.getString("DIENSTGROEP");
row["TOTAALKOSTEN"] = maximoDataSet.getFloat("TOTAALKOSTEN");
row["TOTAALTEFACTUREREN"] = maximoDataSet.getFloat("TOTAALTEFACTUREREN");
row["RESOURCEKOSTEN"] = maximoDataSet.getFloat("RESOURCEKOSTEN");
row["MATERIAALKOSTEN"] = maximoDataSet.getFloat("MATERIAALKOSTEN");
row["PRODUCTPRIJS"] = maximoDataSet.getFloat("PRODUCTPRIJS");
row["RESOURCEPRIJS"] = maximoDataSet.getFloat("RESOURCEPRIJS");
row["MATERIAALPRIJS"] = maximoDataSet.getFloat("MATERIAALPRIJS");
row["Uren"] = maximoDataSet.getFloat("Uren");
row["worklocation"] = maximoDataSet.getString("worklocation");
row["ntwontloctype"] = maximoDataSet.getString("ntwontloctype");
row["ntwarranty"] = maximoDataSet.getBooleanString("ntwarranty");
row["masterpm"] = maximoDataSet.getString("masterpm");
return (true);]]></method>
        </script-data-set>
    </data-sets>
    <page-setup>
        <simple-master-page name="maximoLandscape" id="3012" extends="MaximoSystemLibrary.maximoLandscape">
            <overridden-values>
                <ref-entry baseId="304" name="NewGrid21" id="304"/>
                <ref-entry baseId="305" id="305"/>
                <ref-entry baseId="306" id="306"/>
                <ref-entry baseId="307" id="307"/>
                <ref-entry baseId="308" id="308"/>
                <ref-entry baseId="340" name="NewImage1" id="340"/>
                <ref-entry baseId="309" id="309"/>
                <ref-entry baseId="322" name="NewGrid3" id="322"/>
                <ref-entry baseId="323" id="323"/>
                <ref-entry baseId="324" id="324"/>
                <ref-entry baseId="325" id="325"/>
                <ref-entry baseId="326" id="326"/>
                <ref-entry baseId="328" name="NewText2" id="328"/>
                <ref-entry baseId="327" id="327"/>
                <ref-entry baseId="329" name="NewGrid11" id="329"/>
                <ref-entry baseId="330" id="330"/>
                <ref-entry baseId="331" id="331"/>
                <ref-entry baseId="332" id="332"/>
                <ref-entry baseId="333" id="333"/>
                <ref-entry baseId="334" id="334"/>
                <ref-entry baseId="335" name="NewAutoText2" id="335"/>
                <ref-entry baseId="336" id="336"/>
                <ref-entry baseId="337" name="NewText11" id="337"/>
                <ref-entry baseId="338" id="338"/>
                <ref-entry baseId="339" name="NewAutoText11" id="339"/>
            </overridden-values>
        </simple-master-page>
    </page-setup>
    <body>
        <table id="2619">
            <property name="width">100%</property>
            <property name="dataSet">Data Set</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">KLANT</property>
                    <expression name="expression">dataSetRow["KLANT"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">OVEREENKOMST</property>
                    <expression name="expression">dataSetRow["OVEREENKOMST"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">FACTUURBATCHNR</property>
                    <expression name="expression">dataSetRow["FACTUURBATCHNR"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">STATUSBATCHREGEL</property>
                    <expression name="expression">dataSetRow["STATUSBATCHREGEL"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">PRIJSSCHEMA</property>
                    <expression name="expression">dataSetRow["PRIJSSCHEMA"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">WERKORDER</property>
                    <expression name="expression">dataSetRow["WERKORDER"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">ACTIVUM</property>
                    <expression name="expression">dataSetRow["ACTIVUM"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">NEDTRAINMATERIEELSERIE</property>
                    <expression name="expression">dataSetRow["NEDTRAINMATERIEELSERIE"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">NEDTRAINSERIENUMMER</property>
                    <expression name="expression">dataSetRow["NEDTRAINSERIENUMMER"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">ACTIVUMOMSCHRIJVING</property>
                    <expression name="expression">dataSetRow["ACTIVUMOMSCHRIJVING"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">WERKORDEROMSCHRIJVING</property>
                    <expression name="expression">dataSetRow["WERKORDEROMSCHRIJVING"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">WERKELIJKESTARTDATUM</property>
                    <expression name="expression">dataSetRow["WERKELIJKESTARTDATUM"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">WERKELIJKESTARTTIJD</property>
                    <expression name="expression">dataSetRow["WERKELIJKESTARTTIJD"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">GEPLANDESTARTDATUM</property>
                    <expression name="expression">dataSetRow["GEPLANDESTARTDATUM"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">GEPLANDESTARTTIJD</property>
                    <expression name="expression">dataSetRow["GEPLANDESTARTTIJD"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">DIENST</property>
                    <expression name="expression">dataSetRow["DIENST"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">DIENSTGROEP</property>
                    <expression name="expression">dataSetRow["DIENSTGROEP"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">TOTAALKOSTEN</property>
                    <expression name="expression">dataSetRow["TOTAALKOSTEN"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">TOTAALTEFACTUREREN</property>
                    <expression name="expression">dataSetRow["TOTAALTEFACTUREREN"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">RESOURCEKOSTEN</property>
                    <expression name="expression">dataSetRow["RESOURCEKOSTEN"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">MATERIAALKOSTEN</property>
                    <expression name="expression">dataSetRow["MATERIAALKOSTEN"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">PRODUCTPRIJS</property>
                    <expression name="expression">dataSetRow["PRODUCTPRIJS"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">RESOURCEPRIJS</property>
                    <expression name="expression">dataSetRow["RESOURCEPRIJS"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">MATERIAALPRIJS</property>
                    <expression name="expression">dataSetRow["MATERIAALPRIJS"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">Uren</property>
                    <text-property name="displayName">Uren</text-property>
                    <expression name="expression" type="javascript">dataSetRow["Uren"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">worklocation</property>
                    <expression name="expression" type="javascript">dataSetRow["worklocation"]</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">ntwontloctype</property>
                    <expression name="expression" type="javascript">dataSetRow["ntwontloctype"]</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">ntwarranty</property>
                    <expression name="expression" type="javascript">dataSetRow["ntwarranty"]</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">masterpm</property>
                    <text-property name="displayName">masterpm</text-property>
                    <expression name="expression" type="javascript">dataSetRow["masterpm"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <property name="pageBreakInterval">50</property>
            <list-property name="sort">
                <structure>
                    <expression name="key" type="javascript">row["KLANT"]</expression>
                    <property name="direction">asc</property>
                    <property name="strength">-1</property>
                </structure>
                <structure>
                    <expression name="key" type="javascript">row["OVEREENKOMST"]</expression>
                    <property name="direction">asc</property>
                    <property name="strength">-1</property>
                </structure>
                <structure>
                    <expression name="key" type="javascript">row["FACTUURBATCHNR"]</expression>
                    <property name="direction">asc</property>
                    <property name="strength">-1</property>
                </structure>
            </list-property>
            <column id="2858"/>
            <column id="2859"/>
            <column id="2860"/>
            <column id="2864"/>
            <column id="2865"/>
            <column id="2866"/>
            <column id="3100"/>
            <column id="3065"/>
            <column id="2867"/>
            <column id="2868"/>
            <column id="2869"/>
            <column id="2870"/>
            <column id="2871"/>
            <column id="2874"/>
            <column id="2875"/>
            <column id="2876"/>
            <column id="2877"/>
            <column id="2878"/>
            <column id="2879"/>
            <column id="2881"/>
            <column id="2882"/>
            <column id="2883"/>
            <column id="2884"/>
            <column id="2886"/>
            <column id="2887"/>
            <column id="2888"/>
            <column id="3083"/>
            <column id="3078"/>
            <column id="3073"/>
            <header>
                <row id="3019">
                    <cell id="3020">
                        <property name="colSpan">3</property>
                        <property name="rowSpan">1</property>
                        <text id="3055">
                            <property name="fontSize">7pt</property>
                            <property name="textAlign">left</property>
                            <property name="contentType">auto</property>
                            <text-property name="content"><![CDATA[nt_factuurcontrole v20150703]]></text-property>
                        </text>
                    </cell>
                    <cell id="3026"/>
                    <cell id="3027"/>
                    <cell id="3028"/>
                    <cell id="3096"/>
                    <cell id="3061"/>
                    <cell id="3029"/>
                    <cell id="3030"/>
                    <cell id="3032"/>
                    <cell id="3033"/>
                    <cell id="3034"/>
                    <cell id="3037"/>
                    <cell id="3038"/>
                    <cell id="3039"/>
                    <cell id="3040"/>
                    <cell id="3041"/>
                    <cell id="3042"/>
                    <cell id="3044"/>
                    <cell id="3045"/>
                    <cell id="3046"/>
                    <cell id="3047"/>
                    <cell id="3049"/>
                    <cell id="3050"/>
                    <cell id="3051"/>
                    <cell id="3079"/>
                    <cell id="3074">
                        <label id="3094">
                            <text-property name="text"></text-property>
                        </label>
                    </cell>
                    <cell id="3069"/>
                </row>
                <row id="2905">
                    <cell id="2906">
                        <property name="colSpan">26</property>
                        <property name="rowSpan">1</property>
                        <label id="2432">
                            <property name="fontFamily">"Arial"</property>
                            <property name="fontSize">25pt</property>
                            <property name="color">#005D57</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <text-property name="text">Factuurcontrole</text-property>
                        </label>
                    </cell>
                    <cell id="3080"/>
                    <cell id="3075"/>
                    <cell id="3070"/>
                </row>
                <row id="2620">
                    <property name="backgroundColor">#005D57</property>
                    <property name="fontSize">small</property>
                    <property name="fontWeight">bold</property>
                    <property name="color">#FFFFFF</property>
                    <cell id="2621">
                        <label id="2622">
                            <text-property name="text">Klant</text-property>
                        </label>
                    </cell>
                    <cell id="2623">
                        <label id="2624">
                            <text-property name="text">Overeenkomst</text-property>
                        </label>
                    </cell>
                    <cell id="2625">
                        <label id="2626">
                            <text-property name="text">Factuur-batch Nr</text-property>
                        </label>
                    </cell>
                    <cell id="2633">
                        <label id="2634">
                            <text-property name="text">Status batchregel</text-property>
                        </label>
                    </cell>
                    <cell id="2635">
                        <label id="2636">
                            <text-property name="text">Prijsschema</text-property>
                        </label>
                    </cell>
                    <cell id="2637">
                        <label id="2638">
                            <text-property name="text">Werkorder</text-property>
                        </label>
                    </cell>
                    <cell id="3098">
                        <label id="3101">
                            <text-property name="text">PO Hoofdschema</text-property>
                        </label>
                    </cell>
                    <cell id="3063">
                        <label id="3066">
                            <text-property name="text">Bestede Uren</text-property>
                        </label>
                    </cell>
                    <cell id="2639">
                        <label id="2640">
                            <text-property name="text">Activum</text-property>
                        </label>
                    </cell>
                    <cell id="2641">
                        <label id="2642">
                            <text-property name="text">NedTrain Materieelserie</text-property>
                        </label>
                    </cell>
                    <cell id="2643">
                        <label id="2644">
                            <text-property name="text">NedTrain Serienummer</text-property>
                        </label>
                    </cell>
                    <cell id="2645">
                        <label id="2646">
                            <text-property name="text">Activum-omschrijving</text-property>
                        </label>
                    </cell>
                    <cell id="2647">
                        <label id="2648">
                            <text-property name="text">Werkorder-omschrijving</text-property>
                        </label>
                    </cell>
                    <cell id="2653">
                        <label id="2654">
                            <text-property name="text">Werkelijke startdatum</text-property>
                        </label>
                    </cell>
                    <cell id="2655">
                        <label id="2656">
                            <text-property name="text">Werkelijke starttijd</text-property>
                        </label>
                    </cell>
                    <cell id="2657">
                        <label id="2658">
                            <text-property name="text">Geplande startdatum</text-property>
                        </label>
                    </cell>
                    <cell id="2659">
                        <label id="2660">
                            <text-property name="text">Geplande starttijd</text-property>
                        </label>
                    </cell>
                    <cell id="2661">
                        <label id="2662">
                            <text-property name="text">Dienst</text-property>
                        </label>
                    </cell>
                    <cell id="2663">
                        <label id="2664">
                            <text-property name="text">Dienstgroep</text-property>
                        </label>
                    </cell>
                    <cell id="2667">
                        <label id="2668">
                            <text-property name="text">Totaal kosten</text-property>
                        </label>
                    </cell>
                    <cell id="2669">
                        <label id="2670">
                            <text-property name="text">Totaal te factureren</text-property>
                        </label>
                    </cell>
                    <cell id="2671">
                        <label id="2672">
                            <text-property name="text">Resourcekosten</text-property>
                        </label>
                    </cell>
                    <cell id="2673">
                        <label id="2674">
                            <text-property name="text">Materiaalkosten</text-property>
                        </label>
                    </cell>
                    <cell id="2677">
                        <label id="2678">
                            <text-property name="text">Productprijs</text-property>
                        </label>
                    </cell>
                    <cell id="2679">
                        <label id="2680">
                            <text-property name="text">Resourceprijs</text-property>
                        </label>
                    </cell>
                    <cell id="2681">
                        <label id="2682">
                            <text-property name="text">Materiaalprijs</text-property>
                        </label>
                    </cell>
                    <cell id="3081">
                        <label id="3090">
                            <text-property name="text">Werklocatie</text-property>
                        </label>
                    </cell>
                    <cell id="3076">
                        <label id="3091">
                            <text-property name="text">Locatietype</text-property>
                        </label>
                    </cell>
                    <cell id="3071">
                        <label id="3092">
                            <text-property name="text">Garantie?</text-property>
                        </label>
                    </cell>
                </row>
            </header>
            <detail>
                <row id="2715">
                    <cell id="2716">
                        <data id="2717">
                            <property name="resultSetColumn">KLANT</property>
                        </data>
                    </cell>
                    <cell id="2718">
                        <data id="2907">
                            <property name="resultSetColumn">OVEREENKOMST</property>
                        </data>
                    </cell>
                    <cell id="2720">
                        <data id="2908">
                            <property name="resultSetColumn">FACTUURBATCHNR</property>
                        </data>
                    </cell>
                    <cell id="2728">
                        <data id="2912">
                            <property name="resultSetColumn">STATUSBATCHREGEL</property>
                        </data>
                    </cell>
                    <cell id="2730">
                        <data id="2913">
                            <property name="resultSetColumn">PRIJSSCHEMA</property>
                        </data>
                    </cell>
                    <cell id="2732">
                        <data id="2914">
                            <property name="resultSetColumn">WERKORDER</property>
                        </data>
                    </cell>
                    <cell id="3099">
                        <data id="3103">
                            <property name="resultSetColumn">masterpm</property>
                        </data>
                    </cell>
                    <cell id="3064">
                        <data id="3068">
                            <structure name="numberFormat">
                                <property name="category">Fixed</property>
                                <property name="pattern">###0.00{RoundingMode=HALF_UP}</property>
                            </structure>
                            <property name="resultSetColumn">Uren</property>
                        </data>
                    </cell>
                    <cell id="2734">
                        <data id="2915">
                            <property name="resultSetColumn">ACTIVUM</property>
                        </data>
                    </cell>
                    <cell id="2736">
                        <data id="2916">
                            <property name="resultSetColumn">NEDTRAINMATERIEELSERIE</property>
                        </data>
                    </cell>
                    <cell id="2738">
                        <data id="2917">
                            <property name="resultSetColumn">NEDTRAINSERIENUMMER</property>
                        </data>
                    </cell>
                    <cell id="2740">
                        <data id="2918">
                            <property name="resultSetColumn">ACTIVUMOMSCHRIJVING</property>
                        </data>
                    </cell>
                    <cell id="2742">
                        <data id="2919">
                            <property name="resultSetColumn">WERKORDEROMSCHRIJVING</property>
                        </data>
                    </cell>
                    <cell id="2748">
                        <data id="2922">
                            <property name="resultSetColumn">WERKELIJKESTARTDATUM</property>
                        </data>
                    </cell>
                    <cell id="2750">
                        <data id="2923">
                            <property name="resultSetColumn">WERKELIJKESTARTTIJD</property>
                        </data>
                    </cell>
                    <cell id="2752">
                        <data id="2924">
                            <property name="resultSetColumn">GEPLANDESTARTDATUM</property>
                        </data>
                    </cell>
                    <cell id="2754">
                        <data id="2925">
                            <property name="resultSetColumn">GEPLANDESTARTTIJD</property>
                        </data>
                    </cell>
                    <cell id="2756">
                        <data id="2926">
                            <property name="resultSetColumn">DIENST</property>
                        </data>
                    </cell>
                    <cell id="2758">
                        <data id="2927">
                            <property name="resultSetColumn">DIENSTGROEP</property>
                        </data>
                    </cell>
                    <cell id="2762">
                        <data id="2929">
                            <structure name="numberFormat">
                                <property name="category">Currency</property>
                                <property name="pattern">###0.00</property>
                            </structure>
                            <property name="resultSetColumn">TOTAALKOSTEN</property>
                        </data>
                    </cell>
                    <cell id="2764">
                        <data id="2930">
                            <structure name="numberFormat">
                                <property name="category">Currency</property>
                                <property name="pattern">###0.00</property>
                            </structure>
                            <property name="resultSetColumn">TOTAALTEFACTUREREN</property>
                        </data>
                    </cell>
                    <cell id="2766">
                        <data id="2931">
                            <structure name="numberFormat">
                                <property name="category">Currency</property>
                                <property name="pattern">###0.00</property>
                            </structure>
                            <property name="resultSetColumn">RESOURCEKOSTEN</property>
                        </data>
                    </cell>
                    <cell id="2768">
                        <data id="2932">
                            <structure name="numberFormat">
                                <property name="category">Currency</property>
                                <property name="pattern">###0.00</property>
                            </structure>
                            <property name="resultSetColumn">MATERIAALKOSTEN</property>
                        </data>
                    </cell>
                    <cell id="2772">
                        <data id="2934">
                            <structure name="numberFormat">
                                <property name="category">Currency</property>
                                <property name="pattern">###0.00</property>
                            </structure>
                            <property name="resultSetColumn">PRODUCTPRIJS</property>
                        </data>
                    </cell>
                    <cell id="2774">
                        <data id="2935">
                            <structure name="numberFormat">
                                <property name="category">Currency</property>
                                <property name="pattern">###0.00</property>
                            </structure>
                            <property name="resultSetColumn">RESOURCEPRIJS</property>
                        </data>
                    </cell>
                    <cell id="2776">
                        <data id="2936">
                            <structure name="numberFormat">
                                <property name="category">Currency</property>
                                <property name="pattern">###0.00</property>
                            </structure>
                            <property name="resultSetColumn">MATERIAALPRIJS</property>
                        </data>
                    </cell>
                    <cell id="3082">
                        <data id="3085">
                            <property name="resultSetColumn">worklocation</property>
                        </data>
                    </cell>
                    <cell id="3077">
                        <data id="3095">
                            <property name="resultSetColumn">ntwontloctype</property>
                        </data>
                    </cell>
                    <cell id="3072">
                        <data id="3089">
                            <property name="resultSetColumn">ntwarranty</property>
                        </data>
                    </cell>
                </row>
            </detail>
        </table>
    </body>
</report>